import sys
import os

script_dir = os.path.dirname( __file__ )
pathOfLibraries = os.path.join(script_dir, 'libraries')

pdfIdPath = os.path.join(pathOfLibraries, 'pdfid_PL-0.0.11b')
sys.path.append(pdfIdPath)

origapyPath = os.path.join(pathOfLibraries, 'origapy-0.09')
sys.path.append(origapyPath)

oletoolsPath = os.path.join(pathOfLibraries, 'oletools-0.60.1', 'oletools')
sys.path.append(oletoolsPath)

peepdfPath = os.path.join(pathOfLibraries, 'peepdf-0.3')
sys.path.append(peepdfPath)

import pdfid_PL as pdfid
import origapy
import pyxswf
import oleid
import mraptor
import oleobj
# import peepdf

'''
PDFiD
'''
xmldoc, cleaned = pdfid.PDFiD(r'C:\Users\Shalom\Desktop\ShalomShreyan_CV.pdf', raise_exceptions=True, return_cleaned=True, force=True, output_file='cleaned.pdf') 
pretty_xml_as_string = xmldoc.toprettyxml()
print(pretty_xml_as_string)
if cleaned:
    print('Malicious (according to PDFiD)')
else:
    print('Clean (according to PDFiD)')

'''
Origapy
'''
# pc = origapy.PDF_Cleaner()
# print(pc.clean(r'C:\Users\Shalom\Desktop\ShalomShreyan_CV.pdf', 'cleaned.pdf'))

'''
pyxswf
'''
swf = pyxswf.moduleMain(r'C:\Users\Shalom\Desktop\Document1.rtf', True)

'''
oleid
'''
mal, x = oleid.Main(r'C:\Users\Shalom\Desktop\Document1.rtf')
print(mal)
print(x)

mraptor.Main(r'E:\College\Semester 7\AI & ML in CS\How AI can solve problems in cybersecurity space.pptx')

print(oleobj.Main(r'C:\Users\Shalom\Desktop\Document1.rtf'))

# peepdf.main()